<div class="sorting-container container-fluid">
  <div class="sidebar">
    <%= render "layouts/sidebar"%>
  </div>
  <div class="row">
    <div class="col">
      <header class="playlist-tracks-header">
        <div class="playlist-tracks-header-text mt-5 mb-5 d-flex justify-content-center align-items-center">
          <div class= "w-50 px-5">
            <h1>Harmonic Sorting</h1>
            <p>Sort your Spotify playlists by any of a wide range of musical attributes such as BPM, key, energy, danceability or leave it up to BiteJockey's algorithm to return the playlists best playable order! </p>
          </div>
          <div class="p-3">
            <%= image_tag 'Bite Harmonic Wheel.png', class: "camelot-image" %>
          </div>
        <div>
      </header>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div class="tracks-container mb-5 d-flex justify-content-center">
        <div class="grid" data-controller='sortable' >
          <div class="grid-heading d-flex justify-content-between p-3">
            <div class="image-and-title d-flex">
              <div class="pe-3">
                <%= image_tag @playlist.images.first["url"], size: 180 %>
              </div>
              <div class="playlist-title-description">
                <h1><%= @playlist.name %></h1>
                <p><%= @playlist.description %></p>
                <p><%= @playlist.owner.display_name %> • <%= @playlist.total %> songs • <%= @playlist.public ? 'Public' : 'Private' %></p>
              </div>
            </div>
            <div class="button-container d-flex flex-column align-items-end">
              <button class="update-playlist-button btn btn-success mb-2">Update Playlist</button>
              <button class="create-playlist-button btn btn-success">Create Playlist</button>
            </div>
          </div>
          <div id="harmonic-cards">
          <% counter = 1 %>
            <% @tracks.each do |track| %>
              <div class="harmonic-track-card shadow mb-2 p-3" data-uri-value=<%= track[:uri]%> data-camelot-key=<%= track[:camelot]%>>
                <div class="track-features d-flex justify-content-between align-items-center">
                  <div class="track-title-artist">
                    <h4 class="mb-2"><% counter %> <%= track[:name]  %></h4>
                    <p><%= track[:artist] %></p>
                  </div>
                  <div class="track-audio-features d-flex justify-content-between">
                    <div class="mx-3 d-flex align-items-center flex-column">
                      <span class="d-flex"><p>Key: </p><p class="key-text ms-2"><%= track[:key_text] %></p></span>
                      <span class="d-flex"><p>Camelot Key: </p><p class="key ms-2"><%= track[:camelot] %></p></span>
                      <span class="d-flex"><p class="key ms-2" style="color: transparent;"><%= track[:key] %></p></span>
                    </div>
                    <div class="mx-3">
                      <span class="d-flex"><p>BPM: </p><p class="bpm ms-2"><%= track[:bpm] %></p></span>
                      <span class="d-flex"><p>Danceability: </p><p class="danceability ms-2"><%= track[:danceability] %></p></span>
                      <span class="d-flex"><p>Energy: </p><p class="energy ms-2"><%= track[:energy] %></p></span>
                    </div>
                  </div>
                </div>
              </div>
              <% counter += 1 %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <script id="my_vars_json" type="text/json">
      <%= raw @my_vars.to_json %>
  </script>
